<link rel="import" href="./../../../../polymer/polymer-element.html" />
<link rel="import" href="./../../../../polymer/lib/elements/dom-repeat.html" />
<link rel="import" href="./../../../../polymer/lib/elements/dom-if.html" />

<link rel="import" href="./../themeComponent/index.html" />

<dom-module id="hakuneko-pages">
  <template>
    <style include="theme"></style>
    <style>
      @import url("./style.css");
    </style>
    <div
      id="container"
      style$="background-color: [[ getContainerColor(selectedMedia) ]];"
    >
      <template is="dom-if" if="[[ thumbnailViewMode(media,selectedMedia) ]]">
        <template is="dom-repeat" items="[[ media ]]">
          <div class="container__wrapper">
            <div
              class="container__wrapper_image thumbnail"
              on-click="showViewer"
              title$="[[i18n('pages.page')]] [[ getPage(index) ]]"
              data-page$="[[ getPage(index) ]]"
            >
              <img src$="[[ escapeBackgroundURI(item) ]]" alt="" />
            </div>
          </div>
        </template>
      </template>
      <template is="dom-if" if="[[ pageViewMode(media,selectedMedia) ]]">
        <div
          id="buttons"
          class="actions"
          tabindex="0"
          onblur="this.focus()"
          on-keydown="onKeyDown"
        >
          <i
            class="actions__action mdi mdi-close-circle-outline mdi-18px button"
            title$="[[i18n('general.close')]] (ESC)"
            on-click="hideViewer"
          ></i>
          <span class="actions__title">[[ selectedChapter.title ]]</span>
          <i
            class="actions__action mdi mdi-chevron-down-circle-outline mdi-18px button"
            title$="[[i18n('chapter_down')]] ([[i18n('arrow_left')]])"
            on-click="requestChapterDown"
          ></i>
          <i
            class="actions__action mdi mdi-chevron-up-circle-outline mdi-18px button"
            title="[[i18n('chapter_up')]] ([[i18n('arrow_right')]])"
            on-click="requestChapterUp"
          ></i>
          &nbsp;
          <i
            class="actions__action mdi mdi-arrow-collapse-vertical mdi-18px button"
            title$="[[i18n('pages.title_decrease_spacing')]] (CTRL ➖)"
            on-click="decreaseImagePadding"
          ></i>
          <i
            class="actions__action mdi mdi-arrow-expand-vertical mdi-18px button"
            title$="[[i18n('pages.title_decrease_spacing')]] (CTRL ➕)"
            on-click="increaseImagePadding"
          ></i>
          &nbsp;
          <i
            class="actions__action mdi mdi-plus-circle-outline mdi-18px button"
            title$="[[i18n('pages.title_zoom_in')]] (➕)"
            on-click="zoomIn"
          ></i>
          <i
            class="actions__action mdi mdi-minus-circle-outline mdi-18px button"
            title$="[[i18n('pages.title_zoom_out')]] (➖)"
            on-click="zoomOut"
          ></i>
          &nbsp;
        </div>
        <template is="dom-repeat" items="[[ media ]]" style="margin-top: 1.5em">
          <img
            id$="page_[[ index ]]"
            class="image"
            src$="[[ item ]]"
            style$="width: [[ imageWidth ]]%; margin: [[ imagePadding ]]em;"
            onerror="imgError(this)"
          />
        </template>
      </template>
      <template
        is="dom-if"
        if="[[ videoViewMode(media,selectedMedia) ]]"
        on-dom-change="onVideoElementChanged"
      >
        <div id="fullscreen" on-dblclick="toggleFullscreen">
          <video
            id="video"
            controls
            disablePictureInPicture
            controlsList="nodownload nofullscreen"
          >
            <!-- dummy tracks to show subtitle menu in video player -->
            <template is="dom-repeat" items="[[ media.subtitles ]]">
              <track
                kind="subtitles"
                src="data:text/vtt,WEBVTT"
                label$="[[ item.locale ]]"
                srclang$="[[ item.locale ]]"
              />
            </template>
          </video>
        </div>
      </template>
    </div>
  </template>

  <script src="./script.js"></script>
</dom-module>
