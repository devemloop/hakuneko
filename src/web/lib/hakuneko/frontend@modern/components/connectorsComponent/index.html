<link rel="import" href="./../../../../polymer/polymer-element.html" />
<link rel="import" href="./../../../../polymer/lib/elements/dom-if.html" />
<link rel="import" href="./../../../../polymer/lib/elements/dom-repeat.html" />

<link rel="import" href="./../themeComponent/index.html" />

<dom-module id="hakuneko-connectors">
  <template>
    <style include="theme"></style>
    <style>
      @import url("./style.css");
    </style>
    <input
      type="text"
      class="button"
      on-click="showPopup"
      value$="[[ selectedConnector.label ]]"
      readonly
    />
    <div class$="popup [[ getPopupClass(popupVisibility) ]]">
      <div class="controls" title="Click to cancel the website selection">
        <i
          class="controls__icon mdi mdi-18px mdi-close-box button"
          on-click="closePopup"
        ></i>
        <div class="controls__title">[[i18n('connectors.title')]]</div>
      </div>
      <div class="content">
        <div class="filters">
          <div class="filters__group clear button">
            <div class="filters__group_title" on-click="clearFilters">
              <i
                class="filters__group_title--icon mdi mdi-18px mdi-filter-variant-remove button"
              ></i>
              <div class="filters__group_title--label">[[i18n('connectors.clear_filter')]]</div>
            </div>
          </div>
          <div class="filters__group">
            <div class="filters__group_title">
              <i class="filters__group_title--icon mdi mdi-24px mdi-web"></i>
              <div class="filters__group_title--label">[[i18n('connectors.website')]]</div>
            </div>
            <div class="filters__group_input">
              <input
                id="connectorPattern"
                class="pattern"
                type="text"
                value="{{ connectorPattern::input }}"
                title$="[[i18n('connectors.title_connector_pattern')]]"
              />
            </div>
          </div>
          <div class="filters__group">
            <div class="filters__group_title">
              <i
                class="filters__group_title--icon mdi mdi-24px mdi-book-open-blank-variant"
              ></i>
              <div class="filters__group_title--label">[[i18n('connectors.manga')]]</div>
            </div>
            <div class="filters__group_input">
              <input
                id="mangaPattern"
                class="pattern"
                type="text"
                value="{{ mangaPattern::input }}"
                on-keyup="filterConnectorsByManga"
                title$="[[i18n('connectors.title_manga_pattern')]]"
              />
            </div>
          </div>
          <div class="filters__group group__tags">
            <div
              class="filters__group_title"
              title="Show only websites containing the selected tags"
            >
              <i
                class="filters__group_title--icon mdi mdi-24px mdi-tag-multiple"
              ></i>
              <div class="filters__group_title--label">[[i18n('connectors.tags')]]</div>
            </div>
            <div class="filters__group_tags">
              <template is="dom-repeat" items="[[ tags ]]">
                <span
                  class$="filters__group_tags--tag button [[ getTagClass(selectedTags, item) ]]"
                  on-click="toggleTag"
                  >[[ item.tag ]]</span
                >
              </template>
            </div>
          </div>
        </div>
        <div class="connectors">
          <template
            is="dom-repeat"
            items="[[ connectorList ]]"
            filter="[[ filterConnectors(connectorPattern, selectedTags) ]]"
          >
            <div
              class$="card [[ getConnectorClass(selectedConnector, item) ]]"
              title$="[[i18n('connectors.show_mangas')]]&#10;&#10;[[i18n('connectors.label')]]: [[ item.label ]]&#10;ID: [[ item.id ]]&#10;URL: [[ item.url ]]"
              on-click="selectConnector"
            >
              <img
                class="card__icon"
                src$="[[ item.icon ]]"
                onerror="this.src='/img/connectors/default';"
              />
              <div class="card__info">
                <div class="card__info_title">[[ item.label ]]</div>
                <div class="card__info_tags">
                  <template is="dom-repeat" items="[[ item.tags ]]">
                    <!-- TODO: Translate tags -->
                    <div class="card__info_tags--tag">[[ item ]]</div>
                  </template>
                </div>
              </div>
              <div class="card__actions">
                <i
                  class$="card__actions_action mdi mdi-24px mdi-login-variant link [[ getLoginClass(item.links) ]]"
                  title$="[[i18n('connectors.title_login_page')]]"
                  on-click="openLogin"
                  ></i>
                  <i
                  class$="card__actions_action mdi mdi-24px mdi-account-cash link [[ getDonationClass(item.links) ]]"
                  title$="[[i18n('connectors.title_donation_page')]]"
                  on-click="openDonation"
                ></i>
                <i
                  class="card__actions_action mdi mdi-24px mdi-application-export link active"
                  title$="[[i18n('connectors.open_website')]]&#10;[[i18n('connectors.title_varoius_taks')]]&#10;&#10;&#8226; [[i18n('connectors.title_website_status')]]&#10;&#8226; [[i18n('connectors.title_website_protecction')]]&#10;&#8226; [[i18n('connectors.title_unlock_capthcha')]]"
                  on-click="openWebsite"
                ></i>
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>
  </template>

  <script src="./script.js"></script>
</dom-module>
